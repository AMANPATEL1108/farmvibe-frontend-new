<div class="container mx-auto py-8">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <!-- Left Panel: Profile -->
<div class="bg-white p-6 rounded-lg shadow-lg">
  <div class="flex items-center space-x-4 mb-6">
    <div class="relative group">
      <img [src]="profileImage" class="w-24 h-24 rounded-full border-2 border-gray-300 object-cover">
      <div
        class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 group-hover:bg-opacity-50 rounded-full transition-all duration-300 opacity-0 group-hover:opacity-100">
        <button (click)="openImageUpload()"
          class="text-white p-2 rounded-full hover:bg-blue-600 transition-colors duration-300">📷</button>
        <button (click)="confirmRemoveImage()"
          class="text-white p-2 rounded-full hover:bg-red-600 transition-colors duration-300 ml-1">🗑️</button>
      </div>
    </div>
    <div>
      <h2 class="text-xl font-semibold">Profile Details</h2>
    </div>
  </div>

  <!-- Form showing user details but disabled -->
  <form class="space-y-3">
    <div>
      <label class="block text-sm font-medium text-gray-700">First Name</label>
      <input type="text" [(ngModel)]="user.firstName" name="firstName"
             class="mt-1 block w-full border border-gray-300 rounded-md p-2" disabled>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Last Name</label>
      <input type="text" [(ngModel)]="user.lastName" name="lastName"
             class="mt-1 block w-full border border-gray-300 rounded-md p-2" disabled>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Email</label>
      <input type="email" [(ngModel)]="user.email" name="email"
             class="mt-1 block w-full border border-gray-300 rounded-md p-2" disabled>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Phone</label>
      <input type="text" [(ngModel)]="user.phone" name="phone"
             class="mt-1 block w-full border border-gray-300 rounded-md p-2" disabled>
    </div>

    <button type="button" (click)="openEditDetailsModal()"
      class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
      Edit Details
    </button>
  </form>
</div>

    <!-- Right Panel: Addresses -->
    <div class="bg-white p-6 rounded-lg shadow-lg">
      <h2 class="text-xl font-semibold mb-4">Saved Addresses</h2>
      <div class="space-y-3" *ngFor="let addr of addresses; let i = index">
        <div class="flex items-start justify-between border p-3 rounded bg-gray-50">
          <div class="text-sm">
            <p class="text-gray-500 font-medium mb-1">Address {{i + 1}}</p>
            <p><strong>{{addr.house_number}}</strong>, {{addr.street}}, {{addr.area}}, {{addr.city}} -
              {{addr.pincode}}</p>
            <p class="mt-1">{{addr.first_name}} {{addr.last_name}}</p>
            <p>{{addr.email}}</p>
            <p>{{addr.number}}</p>
          </div>
          <div class="space-x-2">
            <button (click)="openAddressEditModal(addr)"
              class="text-sm bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">Edit</button>
            <button (click)="confirmDeleteAddress(addr.id)"
              class="text-sm bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== Edit Profile Modal ===================== -->
<div *ngIf="editDetailsModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-96">
    <h2 class="text-lg font-semibold mb-4">Edit Profile</h2>
    <form class="space-y-3">
      <input type="text" [(ngModel)]="user.firstName" name="firstName"
        class="w-full border p-2 rounded" placeholder="First Name">
      <input type="text" [(ngModel)]="user.lastName" name="lastName"
        class="w-full border p-2 rounded" placeholder="Last Name">
      <input type="email" [(ngModel)]="user.email" name="email"
        class="w-full border p-2 rounded" placeholder="Email">
      <input type="text" [(ngModel)]="user.phone" name="phone"
        class="w-full border p-2 rounded" placeholder="Phone">
    </form>
    <div class="flex justify-end space-x-2 mt-4">
      <button (click)="closeEditDetailsModal()" class="px-3 py-1 bg-gray-400 text-white rounded">Cancel</button>
      <button (click)="saveProfileWithOtp()" class="px-3 py-1 bg-blue-600 text-white rounded">Save</button>
    </div>
  </div>
</div>

<!-- ===================== Address Edit Modal ===================== -->
<div *ngIf="addressEditModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-96">
    <h2 class="text-lg font-semibold mb-4">Edit Address</h2>
    <form class="space-y-2">
      <input type="text" [(ngModel)]="selectedAddress.house_number" name="house"
        class="w-full border p-2 rounded" placeholder="House No">
      <input type="text" [(ngModel)]="selectedAddress.street" name="street"
        class="w-full border p-2 rounded" placeholder="Street">
      <input type="text" [(ngModel)]="selectedAddress.area" name="area"
        class="w-full border p-2 rounded" placeholder="Area">
      <input type="text" [(ngModel)]="selectedAddress.city" name="city"
        class="w-full border p-2 rounded" placeholder="City">
      <input type="text" [(ngModel)]="selectedAddress.pincode" name="pincode"
        class="w-full border p-2 rounded" placeholder="Pincode">
    </form>
    <div class="flex justify-end space-x-2 mt-4">
      <button (click)="closeAddressEditModal()" class="px-3 py-1 bg-gray-400 text-white rounded">Cancel</button>
      <button (click)="saveEditedAddressWithOtp()" class="px-3 py-1 bg-blue-600 text-white rounded">Save</button>
    </div>
  </div>
</div>

<!-- ===================== OTP Modal ===================== -->
<div *ngIf="otpModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-96">
    <h2 class="text-lg font-semibold mb-4">Verify OTP</h2>
    <p class="text-sm text-gray-600 mb-3">We’ve sent a 6-digit OTP to your registered phone number.</p>
    <input type="text" maxlength="6" [(ngModel)]="enteredOtp"
      class="w-full border border-gray-300 rounded-md p-2 text-center tracking-widest text-lg"
      placeholder="Enter OTP">

    <div class="flex justify-between items-center mt-3">
      <button (click)="resendOtp()" class="text-blue-600 text-sm hover:underline">Resend OTP</button>
      <button (click)="closeOtpModal()" class="text-gray-500 text-sm hover:underline">Cancel</button>
    </div>

    <div class="flex justify-end mt-4 space-x-2">
      <button (click)="verifyOtp()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
        Verify & Continue
      </button>
    </div>
  </div>
</div>
